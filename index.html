<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="test.css">
    <link href="https://fonts.cdnfonts.com/css/ds-digital" rel="stylesheet">
    <title>Website</title>
    <link rel="icon" type="image/jpg" href="Images/Logo.jpg">
</head>
<body class="body">
    <div class="container3">
        <h1 class="counterBox">Count: <span class="counter">0</span></h1>

        <div class="container1">
            <div class="container2">
                <input type="button" value="Nigga" class ="button" title="Click Me" >
        </div>
    </div>
    </div>
    <script src="Action.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js"></script>
  
    <!-- Firebase Firestore Code -->
    <script type="module">
      // Import Firebase libraries
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
      import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";
  
      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyA2axhnlDhVTv5ac5GUpX99rgQQoj0-uXw",
        authDomain: "techtitive-counter.firebaseapp.com",
        projectId: "techtitive-counter",
        storageBucket: "techtitive-counter.firebasestorage.app",
        messagingSenderId: "374532775348",
        appId: "1:374532775348:web:337ceaa95f051eebd066e1",
        measurementId: "G-0C5VJE3VPW"
      };
  
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
  
      // Firestore Reference to the counter document
      const counterRef = doc(db, 'clickData', 'counter');
  
      // HTML Element References
      const clicktarget = document.querySelector('.button');
      const counter = document.querySelector('.counter');
  
      let clickcount = 0;
  
      // Fetch data from Firestore and set the counter
      getDoc(counterRef).then((docSnapshot) => {
        if (docSnapshot.exists()) {
          clickcount = docSnapshot.data().count || 0;
          counter.textContent = clickcount; // Update counter on page
        } else {
          // Initialize the counter document in Firestore if it does not exist
          setDoc(counterRef, { count: 0 });
        }
      });
  
      // Click Event Listener to update counter and Firestore
      clicktarget.addEventListener('click', async () => {
        // Fetch the current counter value from Firestore
        const docSnapshot = await getDoc(counterRef);
        if (docSnapshot.exists()) {
          const currentCount = docSnapshot.data().count || 0;
          const newCount = currentCount + 1;
  
          // Update Firestore with the new counter value
          await setDoc(counterRef, { count: newCount });
  
          // Update the counter on the UI
          counter.textContent = newCount;
        }
      });
    </script>
</body>
</html>
